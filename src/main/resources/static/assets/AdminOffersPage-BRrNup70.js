import{j as e,u as w,g as G,f as T,B as D,C as W,a as Y,b as J,c as K,d as Q}from"./ui-DCtcd1Kk.js";import{r as n,u as X}from"./router-C32cmwfs.js";import{A as Z}from"./AdminLayout-Dt8VV5pt.js";import{T as ee,a as te,b,c as m,d as ae,e as x}from"./table-D9jKlXO1.js";import{B as v}from"./badge-CCKXs842.js";import{c as N,f as re,j as se,U as oe}from"./RootLayout-Bf31PLGy.js";import{c as S,R as le,W as ne,C as ie,b as ce,D as de,a as _,P as ue,O as fe,T as pe}from"./index-Csad-dEI.js";import{c as u,f as E}from"./utils-DCNUdSfE.js";import{t as A}from"./index-XEsyHGvM.js";import{U as ge}from"./Sidebar-CR8TwwPA.js";import{P as me}from"./plus-CCzr7Ia9.js";import"./charts-BMSya-r6.js";import"./react-Csw2ODfV.js";import"./gift-41HnvwwA.js";/**
 * @license lucide-react v0.501.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],he=N("square-pen",xe);/**
 * @license lucide-react v0.501.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ve=N("trash-2",je);/**
 * @license lucide-react v0.501.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ae=N("user-check",ye);var O="AlertDialog",[De,ut]=re(O,[S]),d=S(),k=t=>{const{__scopeAlertDialog:a,...r}=t,s=d(a);return e.jsx(le,{...s,...r,modal:!0})};k.displayName=O;var Ne="AlertDialogTrigger",Ce=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,l=d(r);return e.jsx(pe,{...l,...s,ref:a})});Ce.displayName=Ne;var be="AlertDialogPortal",R=t=>{const{__scopeAlertDialog:a,...r}=t,s=d(a);return e.jsx(ue,{...s,...r})};R.displayName=be;var Ee="AlertDialogOverlay",M=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,l=d(r);return e.jsx(fe,{...l,...s,ref:a})});M.displayName=Ee;var h="AlertDialogContent",[we,Te]=De(h),Se=G("AlertDialogContent"),P=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,children:s,...l}=t,p=d(r),f=n.useRef(null),y=w(a,f),g=n.useRef(null);return e.jsx(ne,{contentName:h,titleName:$,docsSlug:"alert-dialog",children:e.jsx(we,{scope:r,cancelRef:g,children:e.jsxs(ie,{role:"alertdialog",...p,...l,ref:y,onOpenAutoFocus:se(l.onOpenAutoFocus,i=>{var j;i.preventDefault(),(j=g.current)==null||j.focus({preventScroll:!0})}),onPointerDownOutside:i=>i.preventDefault(),onInteractOutside:i=>i.preventDefault(),children:[e.jsx(Se,{children:s}),e.jsx(Oe,{contentRef:f})]})})})});P.displayName=h;var $="AlertDialogTitle",I=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,l=d(r);return e.jsx(ce,{...l,...s,ref:a})});I.displayName=$;var L="AlertDialogDescription",F=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,l=d(r);return e.jsx(de,{...l,...s,ref:a})});F.displayName=L;var _e="AlertDialogAction",U=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,l=d(r);return e.jsx(_,{...l,...s,ref:a})});U.displayName=_e;var z="AlertDialogCancel",B=n.forwardRef((t,a)=>{const{__scopeAlertDialog:r,...s}=t,{cancelRef:l}=Te(z,r),p=d(r),f=w(a,l);return e.jsx(_,{...p,...s,ref:f})});B.displayName=z;var Oe=({contentRef:t})=>{const a=`\`${h}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${h}\` by passing a \`${L}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${h}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{var s;document.getElementById((s=t.current)==null?void 0:s.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},ke=k,Re=R,Me=M,Pe=P,$e=U,Ie=B,Le=I,Fe=F;function Ue({...t}){return e.jsx(ke,{"data-slot":"alert-dialog",...t})}function ze({...t}){return e.jsx(Re,{"data-slot":"alert-dialog-portal",...t})}function Be({className:t,...a}){return e.jsx(Me,{"data-slot":"alert-dialog-overlay",className:u("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function He({className:t,...a}){return e.jsxs(ze,{children:[e.jsx(Be,{}),e.jsx(Pe,{"data-slot":"alert-dialog-content",className:u("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...a})]})}function Ve({className:t,...a}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:u("flex flex-col gap-2 text-center sm:text-left",t),...a})}function qe({className:t,...a}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:u("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function Ge({className:t,...a}){return e.jsx(Le,{"data-slot":"alert-dialog-title",className:u("text-lg font-semibold",t),...a})}function We({className:t,...a}){return e.jsx(Fe,{"data-slot":"alert-dialog-description",className:u("text-muted-foreground text-sm",t),...a})}function Ye({className:t,...a}){return e.jsx($e,{className:u(T(),t),...a})}function Je({className:t,...a}){return e.jsx(Ie,{className:u(T({variant:"outline"}),t),...a})}const Ke=({onEditOffer:t})=>{const[a,r]=n.useState([]),[s,l]=n.useState(!0),[p,f]=n.useState(null),[y,g]=n.useState(!1),[i,j]=n.useState(null);n.useEffect(()=>{C()},[]);const C=async()=>{l(!0),f(null);try{const o=localStorage.getItem("token"),c=await fetch("/api/admin/offers",{headers:{Authorization:`Bearer ${o}`}});if(!c.ok)throw new Error(`Failed to fetch offers: ${c.status}`);const q=await c.json();r(q)}catch(o){console.error("Error fetching offers:",o),f(o.message||"Failed to load offers"),A.error("Failed to load offers")}finally{l(!1)}},H=o=>{j(o),g(!0)},V=async()=>{if(i)try{const o=localStorage.getItem("token"),c=await fetch(`/api/admin/offers/${i.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}});if(!c.ok)throw new Error(`Failed to delete offer: ${c.status}`);A.success("Offer deleted successfully"),C()}catch(o){console.error("Error deleting offer:",o),A.error(o.message||"Failed to delete offer")}finally{g(!1),j(null)}};return s?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):p?e.jsx("div",{className:"bg-destructive/15 text-destructive px-4 py-2 rounded-md",children:p}):a.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No offers found."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(ee,{children:[e.jsx(te,{children:e.jsxs(b,{children:[e.jsx(m,{children:"Title"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Validity"}),e.jsx(m,{children:"Target Type"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(ae,{children:a.map(o=>{var c;return e.jsxs(b,{children:[e.jsx(x,{className:"font-medium",children:o.title}),e.jsx(x,{children:o.category||"-"}),e.jsx(x,{children:e.jsxs("div",{className:"text-xs",children:[e.jsxs("p",{children:["From: ",E(new Date(o.validFrom),"dd MMM yyyy")]}),e.jsxs("p",{children:["Until: ",E(new Date(o.validUntil),"dd MMM yyyy")]})]})}),e.jsxs(x,{children:[o.targetType==="ALL_USERS"&&e.jsxs(v,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),"All Users"]}),o.targetType==="SELECTED_USERS"&&e.jsxs(v,{className:"flex items-center gap-1 bg-blue-500",children:[e.jsx(Ae,{className:"h-3 w-3"}),"Selected (",((c=o.targetUsers)==null?void 0:c.length)||0,")"]}),o.targetType==="CRITERIA_BASED"&&e.jsxs(v,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3"}),"Criteria"]})]}),e.jsx(x,{children:o.active?e.jsx(v,{className:"bg-green-500",children:"Active"}):e.jsx(v,{variant:"outline",children:"Inactive"})}),e.jsx(x,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>t(o),children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>H(o),children:e.jsx(ve,{className:"h-4 w-4 text-destructive"})})]})})]},o.id)})})]})}),e.jsx(Ue,{open:y,onOpenChange:g,children:e.jsxs(He,{children:[e.jsxs(Ve,{children:[e.jsx(Ge,{children:"Confirm Deletion"}),e.jsxs(We,{children:['Are you sure you want to delete the offer "',i==null?void 0:i.title,'"? This action cannot be undone.']})]}),e.jsxs(qe,{children:[e.jsx(Je,{children:"Cancel"}),e.jsx(Ye,{onClick:V,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})},ft=()=>{const t=X(),a=()=>{t("/admin/offers/create")},r=s=>{t(`/admin/offers/edit/${s.id}`)};return e.jsx(Z,{children:e.jsxs("div",{className:"flex-1 space-y-4 p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Offers Management"}),e.jsxs(D,{onClick:a,children:[e.jsx(me,{className:"mr-2 h-4 w-4"})," Create Offer"]})]}),e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsx(J,{children:"All Offers"}),e.jsx(K,{children:"Manage special offers for users"})]}),e.jsx(Q,{children:e.jsx(Ke,{onEditOffer:r})})]})]})})};export{ft as default};
