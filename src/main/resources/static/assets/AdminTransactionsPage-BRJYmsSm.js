import{j as e,C as g,a as C,b as v,c as A,d as S}from"./ui-DCtcd1Kk.js";import{r as o}from"./router-C32cmwfs.js";import{A as E}from"./AdminLayout-Dt8VV5pt.js";import{T as L,a as D,b as u,c as a,d as I,e as r}from"./table-D9jKlXO1.js";import{I as B}from"./input-DjdrYohH.js";import{B as F}from"./badge-CCKXs842.js";import{t as k}from"./index-XEsyHGvM.js";import{S as R}from"./search-T1dYjenp.js";import"./charts-BMSya-r6.js";import"./react-Csw2ODfV.js";import"./utils-DCNUdSfE.js";import"./Sidebar-CR8TwwPA.js";import"./RootLayout-Bf31PLGy.js";import"./gift-41HnvwwA.js";const X=()=>{const[d,f]=o.useState([]),[h,m]=o.useState([]),[p,x]=o.useState(!0),[c,j]=o.useState("");o.useEffect(()=>{N()},[]),o.useEffect(()=>{if(c.trim()==="")m(d);else{const s=c.toLowerCase();m(d.filter(t=>t.fromAccountNumber.toLowerCase().includes(s)||t.toAccountNumber.toLowerCase().includes(s)||t.description.toLowerCase().includes(s)||t.status.toLowerCase().includes(s)))}},[c,d]);const N=async()=>{x(!0);try{const s=localStorage.getItem("token"),t=await fetch("/api/users",{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Failed to fetch user data");const b=await t.json();let i=[];for(const l of b)if(l.id)try{const n=await fetch(`/api/users/${l.id}/transactions`,{headers:{Authorization:`Bearer ${s}`}});if(n.ok){const y=await n.json();i=[...i,...y]}}catch(n){console.error(`Error fetching transactions for user ${l.id}:`,n)}i.sort((l,n)=>new Date(n.timestamp).getTime()-new Date(l.timestamp).getTime()),f(i),m(i)}catch(s){console.error("Error fetching transactions:",s),k.error("Failed to load transactions data")}finally{x(!1)}},w=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s),T=s=>{switch(s.toUpperCase()){case"COMPLETED":return"default";case"PENDING":return"outline";case"FAILED":return"destructive";default:return"secondary"}};return e.jsx(E,{children:e.jsxs("div",{className:"flex-1 space-y-4 p-6 md:p-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Transactions Overview"})}),e.jsxs(g,{children:[e.jsxs(C,{children:[e.jsx(v,{children:"All Transactions"}),e.jsx(A,{children:"View and monitor transactions across all accounts"})]}),e.jsxs(S,{children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(B,{placeholder:"Search transactions...",value:c,onChange:s=>j(s.target.value),className:"pl-8"})]})}),p?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(L,{children:[e.jsx(D,{children:e.jsxs(u,{children:[e.jsx(a,{children:"Transaction ID"}),e.jsx(a,{children:"From Account"}),e.jsx(a,{children:"To Account"}),e.jsx(a,{children:"Amount"}),e.jsx(a,{children:"Date & Time"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Description"})]})}),e.jsx(I,{children:h.length===0?e.jsx(u,{children:e.jsx(r,{colSpan:7,className:"text-center py-4",children:c?"No transactions found matching your search":"No transactions found"})}):h.map(s=>e.jsxs(u,{children:[e.jsx(r,{className:"font-medium",children:s.id}),e.jsx(r,{children:s.fromAccountNumber}),e.jsx(r,{children:s.toAccountNumber}),e.jsx(r,{children:w(s.amount)}),e.jsx(r,{children:new Date(s.timestamp).toLocaleString()}),e.jsx(r,{children:e.jsx(F,{variant:T(s.status),children:s.status})}),e.jsx(r,{className:"max-w-[200px] truncate",children:e.jsx("span",{title:s.description,children:s.description})})]},s.id))})]})})]})]})]})})};export{X as default};
